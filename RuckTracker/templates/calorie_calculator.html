<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Analytics Tag -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYLNW662H0"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} 
    gtag('js', new Date());
    gtag('config', 'G-PYLNW662H0');
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rucking Calorie Calculator | Compare Methods (Mechanical, MET, HR)</title>
  <meta name="description" content="Rucking calorie calculator. Enter your stats to compare calories by three methods: Mechanical (Pandolf), MET-based, and Heart Rate-based. Dial in accurate calorie estimates for your rucks." />
  <link rel="canonical" href="https://getrucky.com/rucking-calorie-calculator" />
  <link rel="stylesheet" href="/static/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --brand-green: #00AA55;
      --bg-offwhite: #FAF9F7;
      --text: #111;
      --content-max: 1200px;
    }
    body { background: var(--bg-offwhite) !important; color: var(--text) !important; }
    .site-header { max-width: var(--content-max); margin: 24px auto 8px; padding: 0 16px; display: flex; align-items: center; height: 56px; }
    .brand { color: var(--brand-green); font-weight: 800; font-size: 1.25rem; letter-spacing: .5px; text-decoration: none; }
  </style>
  <meta property="og:title" content="Rucking Calorie Calculator" />
  <meta property="og:description" content="Compare rucking calories with Mechanical (Pandolf), MET-based, and HR-based methods." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://getrucky.com/rucking-calorie-calculator" />
  <meta name="twitter:card" content="summary_large_image" />
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Rucking Calorie Calculator",
    "url": "https://getrucky.com/rucking-calorie-calculator",
    "description": "Rucking calorie calculator. Enter your stats to compare calories by three methods: Mechanical (Pandolf), MET-based, and Heart Rate-based.",
    "isPartOf": {"@type":"WebSite","name":"Get Rucky","url":"https://getrucky.com"}
  }
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Rucking Calorie Calculator",
    "applicationCategory": "FitnessApplication",
    "operatingSystem": "Any",
    "url": "https://getrucky.com/rucking-calorie-calculator",
    "offers": {"@type": "Offer", "price": "0", "priceCurrency": "USD"}
  }
  </script>
  <style>
    .grid { display: grid; grid-template-columns: 1fr; gap: 1rem; }
    /* Keep single column on desktop so results appear below inputs */
    @media (min-width: 900px) { .grid { grid-template-columns: 1fr; column-gap: 1rem; row-gap: 1rem; } }
    .card { padding: 1rem; border-radius: 8px; background: #fff; box-shadow: 0 2px 10px rgba(0,0,0,0.06); }
    /* Darker descriptive text */
    .muted { color: #444; font-size: .9rem; }
    .subtitle { color: #444; }
    .row { display:flex; gap: .75rem; }
    .row > div { flex: 1; }
    label { font-weight: 600; display:block; margin-bottom: .25rem; }
    input, select { width: 100%; padding: .6rem .7rem; border: 1px solid #ddd; border-radius: 6px; font-size: 1rem; }
    .results td, .results th { padding: .5rem .6rem; border-bottom: 1px solid #eee; text-align: right; }
    .results th:first-child, .results td:first-child { text-align: left; }
    /* Left-align the Notes column */
    .results th:last-child, .results td:last-child { text-align: left; }
    .pill { background:#f2f2f2; padding:.2rem .5rem; border-radius: 999px; font-size:.85rem; }
  </style>
</head>
<body>
  <header class="site-header">
    <a class="brand" href="/">RUCK</a>
  </header>
  <main class="content-container">
    <header style="margin-bottom: 1rem;">
      <h1 style="margin-bottom: .25rem;">Rucking Calorie Calculator</h1>
      <p class="subtitle">Compare calories by three methods used in the Ruck! app.</p>
    </header>

    <section class="grid" aria-label="Calorie input and results">
      <div class="card">
        <h2 style="margin-top:0;">Inputs</h2>
        <div class="row">
          <div>
            <label>Units</label>
            <div style="display:flex; gap:.5rem; align-items:center;">
              <button id="unitsMetric" type="button" aria-pressed="true" style="padding:.45rem .8rem; border:1px solid #ddd; border-radius:6px; background:#222; color:#fff; cursor:pointer;">Metric</button>
              <button id="unitsImperial" type="button" aria-pressed="false" style="padding:.45rem .8rem; border:1px solid #ddd; border-radius:6px; background:#fff; color:#222; cursor:pointer;">Imperial</button>
            </div>
            <input id="unitSystem" type="hidden" value="metric" />
          </div>
          <div></div>
        </div>
        <div class="row">
          <div>
            <label for="weightKg">Body weight (<span id="unitWeight">kg</span>)</label>
            <input id="weightKg" type="number" min="20" max="250" step="0.1" value="80" />
          </div>
          <div>
            <label for="ruckKg">Ruck weight (<span id="unitRuck">kg</span>)</label>
            <input id="ruckKg" type="number" min="0" max="60" step="0.1" value="10" />
          </div>
        </div>
        <div class="row">
          <div>
            <label for="distanceKm">Distance (<span id="unitDistance">km</span>)</label>
            <input id="distanceKm" type="number" min="0" max="100" step="0.01" value="5" />
          </div>
          <div>
            <label for="duration">Duration (hh:mm)</label>
            <input id="duration" type="text" value="01:00" placeholder="hh:mm" />
          </div>
        </div>
        <div class="row">
          <div>
            <label for="elevGain">Elevation gain (<span id="unitElev">m</span>)</label>
            <input id="elevGain" type="number" min="0" max="5000" step="1" value="50" />
          </div>
          <div>
            <label for="elevLoss">Elevation loss (<span id="unitElev2">m</span>)</label>
            <input id="elevLoss" type="number" min="0" max="5000" step="1" value="0" />
          </div>
        </div>
        <div class="row">
          <div>
            <label for="gender">Gender</label>
            <select id="gender">
              <option value="male">Male</option>
              <option value="female">Female</option>
              <option value="unspecified" selected>Unspecified</option>
            </select>
          </div>
          <div>
            <label for="age">Age (for HR method)</label>
            <input id="age" type="number" min="10" max="90" step="1" value="30" />
          </div>
        </div>
        <div class="row">
          <div>
            <label for="avgHr">Average Heart Rate (bpm)</label>
            <input id="avgHr" type="number" min="60" max="220" step="1" value="140" />
            <p class="muted">Optional. If blank, HR method will show N/A.</p>
          </div>
          <div>
            <label for="terrain">Terrain</label>
            <select id="terrain">
              <option value="1.00">Pavement (1.00)</option>
              <option value="1.05">Gravel / packed dirt (1.05)</option>
              <option value="1.10">Trail / grass (1.10)</option>
              <option value="1.20">Sand / snow (1.20)</option>
            </select>
          </div>
        </div>
        <button id="calcBtn" style="margin-top: .75rem; padding:.7rem 1.2rem; border:0; background:#222; color:#fff; border-radius:6px; cursor:pointer;">Calculate</button>
        <p class="muted" style="margin-top:.5rem;">All methods follow the app logic in <span class="pill">mechanical (Pandolf)</span>, <span class="pill">MET-based</span>, and <span class="pill">HR-based (Keytel)</span>.</p>
      </div>

      <div class="card">
        <h2 style="margin-top:0;">Results</h2>
        <table class="results" style="width:100%; border-collapse: collapse;">
          <thead>
            <tr>
              <th>Method</th>
              <th>Calories</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Mechanical (Pandolf)</td>
              <td id="mechOut">—</td>
              <td class="muted">Terrain & grade aware. Models load, speed, and slope to approximate mechanical work when HR isn't available.</td>
            </tr>
            <tr>
              <td>MET-based</td>
              <td id="metOut">—</td>
              <td class="muted">Speed, grade, load; terrain factor. Uses standardized metabolic equivalents and is simpler but less individualized.</td>
            </tr>
            <tr>
              <td>HR-based</td>
              <td id="hrOut">—</td>
              <td class="muted">Keytel equation using avg HR. Most personal if HR data is accurate, but can vary with stress, heat, and caffeine.</td>
            </tr>
          </tbody>
        </table>
        <p class="muted" id="fusionNote" style="display:none; margin-top:.6rem;">Tip: With HR available in the app, we blend HR and mechanical for best accuracy.</p>
      </div>
    </section>
  </main>

  <footer class="footer-pinned">
    <div class="footer-links">
      <a href="/">Home</a> |
      <a href="/blog">Blog</a> | <a href="/rucking-calorie-calculator">Rucking Calorie Calculator</a> |
      <a href="/privacy">Privacy Policy</a> |
      <a href="/terms">Terms of Service</a> |
      <a href="/support">Support</a>
    </div>
    <div class="copyright">
      &copy; 2025 Get Rucky, Inc. All rights reserved.
    </div>
  </footer>

  <script>
    function parseDuration(hhmm) {
      const m = /^\s*(\d{1,2}):(\d{2})\s*$/.exec(hhmm || '');
      if (!m) return 0;
      const h = parseInt(m[1], 10); const min = parseInt(m[2], 10);
      if (min >= 60) return 0;
      return h * 3600 + min * 60;
    }
    function kmhToMph(kmh){ return kmh * 0.621371; }
    function clamp(x, a, b){ return Math.min(Math.max(x, a), b); }

    // Unit handling
    const KG_PER_LB = 0.45359237;
    const LB_PER_KG = 1 / KG_PER_LB;
    const KM_PER_MI = 1.609344;
    const MI_PER_KM = 1 / KM_PER_MI;
    const M_PER_FT = 0.3048;
    const FT_PER_M = 1 / M_PER_FT;

    function getUnitSystem(){
      const sel = document.getElementById('unitSystem');
      return sel ? sel.value : 'metric';
    }

    function updateUnitLabels(unit){
      const isImp = unit === 'imperial';
      const weightLabel = document.getElementById('unitWeight');
      const ruckLabel = document.getElementById('unitRuck');
      const distLabel = document.getElementById('unitDistance');
      const elevLabel = document.getElementById('unitElev');
      const elevLabel2 = document.getElementById('unitElev2');
      if (weightLabel) weightLabel.textContent = isImp ? 'lb' : 'kg';
      if (ruckLabel) ruckLabel.textContent = isImp ? 'lb' : 'kg';
      if (distLabel) distLabel.textContent = isImp ? 'mi' : 'km';
      if (elevLabel) elevLabel.textContent = isImp ? 'ft' : 'm';
      if (elevLabel2) elevLabel2.textContent = isImp ? 'ft' : 'm';
    }

    function convertNumber(v, factor){
      const n = parseFloat(v);
      if (isNaN(n)) return '';
      const out = n * factor;
      // keep reasonable precision for UI
      return Math.round(out * 1000) / 1000;
    }

    function convertInputs(fromUnit, toUnit){
      if (fromUnit === toUnit) return;
      const toImp = (toUnit === 'imperial');
      const weightEl = document.getElementById('weightKg');
      const ruckEl = document.getElementById('ruckKg');
      const distEl = document.getElementById('distanceKm');
      const gainEl = document.getElementById('elevGain');
      const lossEl = document.getElementById('elevLoss');

      if (weightEl) weightEl.value = convertNumber(weightEl.value, toImp ? LB_PER_KG : KG_PER_LB);
      if (ruckEl) ruckEl.value = convertNumber(ruckEl.value, toImp ? LB_PER_KG : KG_PER_LB);
      if (distEl) distEl.value = convertNumber(distEl.value, toImp ? MI_PER_KM : KM_PER_MI);
      if (gainEl) gainEl.value = convertNumber(gainEl.value, toImp ? FT_PER_M : M_PER_FT);
      if (lossEl) lossEl.value = convertNumber(lossEl.value, toImp ? FT_PER_M : M_PER_FT);
    }

    // MET calculator pieces matching lib/core/utils/met_calculator.dart
    function calcRuckingMetByGrade(speedMph, grade, ruckWeightLbs){
      let baseMet;
      if (speedMph < 2.0) baseMet = 2.5;
      else if (speedMph < 2.5) baseMet = 3.0;
      else if (speedMph < 3.0) baseMet = 3.5;
      else if (speedMph < 3.5) baseMet = 4.0;
      else if (speedMph < 4.0) baseMet = 4.5;
      else if (speedMph < 5.0) baseMet = 5.0;
      else baseMet = 6.0;

      let gradeAdj = 0.0;
      if (grade > 0) {
        gradeAdj = grade * 0.6 * (speedMph / 4.0);
      } else if (grade < 0) {
        const absG = Math.abs(grade);
        if (absG <= 10) gradeAdj = -absG * 0.1; else gradeAdj = (absG - 10) * 0.15;
      }

      let loadAdj = 0.0;
      if (ruckWeightLbs > 0) loadAdj = Math.min(ruckWeightLbs * 0.05, 5.0);

      const finalMet = clamp(baseMet + gradeAdj + loadAdj, 2.0, 15.0);
      return finalMet;
    }

    function calcCaloriesMet(weightKgTotal, durationMinutes, metValue){
      const hours = durationMinutes / 60.0;
      return Math.max(0, metValue * weightKgTotal * hours);
    }

    // Mechanical (Enhanced Pandolf with GORUCK-style load ratio adjustment)
    function calcMechanicalPandolf({userWeightKg, ruckWeightKg, speedKmh, gradePct, terrainMultiplier, elapsedSeconds}){
      const v = clamp(speedKmh / 3.6, 0.0, 3.0); // m/s
      const W = userWeightKg;
      const L = ruckWeightKg;
      const G = gradePct; // percent
      const eta = clamp(terrainMultiplier, 0.8, 1.3);
      const lw = (W > 0) ? (L / W) : 0.0;
      const termLoad = 2.0 * (W + L) * (lw * lw);
      const termSpeedGrade = eta * (W + L) * (1.5 * v * v + 0.35 * v * clamp(G, -20.0, 30.0));
      let M = 1.5 * W + termLoad + termSpeedGrade; // Watts
      M = clamp(M, 50.0, 800.0);
      
      // GORUCK-inspired load ratio adjustment to address Pandolf underestimation
      // Research shows 12-33% underestimation, scaling with load/body weight ratio and speed
      const loadRatio = lw; // L/W ratio (0.0 to ~0.33 for reasonable loads)
      const speedMph = speedKmh * 0.621371;
      
      // Calculate adjustment factor based on load ratio and speed
      // At 33% body weight + 4mph: ~27% increase (matches research)
      // Scales down for lighter loads and slower speeds
      let adjustmentFactor = 1.0;
      if (loadRatio > 0 && speedMph > 2.0) {
        // Base adjustment scales with load ratio (0-27% at max)
        const baseAdjustment = Math.min(loadRatio * 0.82, 0.27); // Cap at 27%
        // Speed factor: more adjustment at higher speeds (research shows this)
        const speedFactor = Math.min((speedMph - 2.0) / 2.0, 1.0); // 0-1 factor for 2-4mph+
        adjustmentFactor = 1.0 + (baseAdjustment * speedFactor);
      }
      
      // Apply the research-based adjustment
      M = M * adjustmentFactor;
      
      const kcalPerSec = (M / 4186.0);
      let kcal = kcalPerSec * elapsedSeconds;
      if (speedKmh < 0.5 && elapsedSeconds > 0) kcal *= 0.2;
      return Math.max(0, kcal);
    }

    // Heart-rate based (Keytel equations)
    function calcCaloriesHR({avgHr, weightKg, age, gender, durationMinutes}){
      if (!avgHr || avgHr <= 0) return null;
      let calsPerMin;
      if (gender === 'female') {
        calsPerMin = (-20.4022 + (0.4472 * avgHr) - (0.1263 * weightKg) + (0.074 * age)) / 4.184;
      } else {
        calsPerMin = (-55.0969 + (0.6309 * avgHr) + (0.1988 * weightKg) + (0.2017 * age)) / 4.184;
      }
      const total = calsPerMin * durationMinutes;
      return Math.max(0, total);
    }

    function calculate(){
      const unit = getUnitSystem();
      let weightKg = parseFloat(document.getElementById('weightKg').value) || 0;
      let ruckKg = parseFloat(document.getElementById('ruckKg').value) || 0;
      let distanceKm = parseFloat(document.getElementById('distanceKm').value) || 0;
      let elevGain = parseFloat(document.getElementById('elevGain').value) || 0;
      let elevLoss = parseFloat(document.getElementById('elevLoss').value) || 0;
      // Convert UI values back to metric if imperial is selected
      if (unit === 'imperial'){
        weightKg = weightKg * KG_PER_LB;
        ruckKg = ruckKg * KG_PER_LB;
        distanceKm = distanceKm * KM_PER_MI;
        elevGain = elevGain * M_PER_FT;
        elevLoss = elevLoss * M_PER_FT;
      }
      const genderSel = document.getElementById('gender').value;
      const age = parseInt(document.getElementById('age').value, 10) || 30;
      const terrain = parseFloat(document.getElementById('terrain').value) || 1.0;
      const avgHr = parseInt(document.getElementById('avgHr').value, 10);
      const elapsed = parseDuration(document.getElementById('duration').value);
      const durationHours = elapsed / 3600.0;
      const durationMinutes = elapsed / 60.0;
      const speedKmh = (durationHours > 0) ? (distanceKm / durationHours) : 0;

      // grade
      let gradePct = 0.0;
      if (distanceKm > 0) gradePct = ((elevGain - elevLoss) / (distanceKm * 1000)) * 100.0;

      // MET path
      const speedMph = kmhToMph(speedKmh);
      const ruckLbs = ruckKg * 2.20462;
      const metVal = calcRuckingMetByGrade(speedMph, gradePct, ruckLbs);
      let metCalories = calcCaloriesMet(weightKg + ruckKg, durationMinutes, metVal) * terrain;

      // Mechanical path
      const mechCalories = calcMechanicalPandolf({
        userWeightKg: weightKg,
        ruckWeightKg: ruckKg,
        speedKmh: speedKmh,
        gradePct: gradePct,
        terrainMultiplier: terrain,
        elapsedSeconds: elapsed,
      });

      // HR path
      const hrGender = (genderSel === 'female') ? 'female' : 'male';
      const hrCalories = calcCaloriesHR({
        avgHr: avgHr,
        weightKg: weightKg,
        age: age,
        gender: hrGender,
        durationMinutes: durationMinutes,
      });

      // Apply small sex adjustment to MET if gender unspecified (mirroring app fusion behavior)
      if (genderSel === 'unspecified') {
        metCalories *= 0.925;
      }

      // Render
      const fmt = (x) => (x == null || isNaN(x)) ? 'N/A' : Math.round(x).toLocaleString();
      document.getElementById('mechOut').textContent = fmt(mechCalories);
      document.getElementById('metOut').textContent = fmt(metCalories);
      document.getElementById('hrOut').textContent = hrCalories == null ? 'N/A' : fmt(hrCalories);
      document.getElementById('fusionNote').style.display = (hrCalories != null) ? 'block' : 'none';
    }

    document.getElementById('calcBtn').addEventListener('click', function(){
      try { calculate(); gtag('event', 'calculate', { 'event_category': 'calorie_calculator' }); } catch(e){}
    });

    // Units setup with toggle buttons
    (function initUnits(){
      const unitHidden = document.getElementById('unitSystem');
      const btnMetric = document.getElementById('unitsMetric');
      const btnImperial = document.getElementById('unitsImperial');
      let last = unitHidden?.value || 'metric';
      function setActive(next){
        if (!unitHidden) return;
        convertInputs(last, next);
        unitHidden.value = next;
        updateUnitLabels(next);
        last = next;
        const metricActive = next === 'metric';
        if (btnMetric){
          btnMetric.setAttribute('aria-pressed', metricActive ? 'true' : 'false');
          btnMetric.style.background = metricActive ? '#222' : '#fff';
          btnMetric.style.color = metricActive ? '#fff' : '#222';
        }
        if (btnImperial){
          btnImperial.setAttribute('aria-pressed', metricActive ? 'false' : 'true');
          btnImperial.style.background = metricActive ? '#fff' : '#222';
          btnImperial.style.color = metricActive ? '#222' : '#fff';
        }
        try { calculate(); gtag('event', 'unit_change', { 'event_category': 'calorie_calculator', 'unit': next }); } catch(e){}
      }
      btnMetric?.addEventListener('click', () => setActive('metric'));
      btnImperial?.addEventListener('click', () => setActive('imperial'));
      updateUnitLabels(last);
      setActive(last);
    })();

    // Initial calc
    updateUnitLabels(getUnitSystem());
    calculate();
  </script>
</body>
</html>
